<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见
    看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见看不见</h1>
<!--date-src属性仅仅是无限的组中的一个 data-* 属性，其不具有所定义的含义
    所以图片首先不会加载-->
<img data-src="./原型.png">
<img data-src="./原型链.png">
</body>
<script>
    // 当访问一个页面的时候，先把img元素或是其他元素的背景图片路径替换成一张大小为1*1px图片的路径（这样就只需请求一次）
    // 当图片出现在浏览器的可视区域内时，才设置图片真正的路径，让图片显示出来。这就是图片懒加载。
    //方法一：
    const image_a = document.querySelectorAll("img")
    // 为鼠标滚动事件添加监听
    window.addEventListener("scroll",(e)=>{
        // 每次滚动就遍历全部的图片
        image_a.forEach(image=>{
            // 获取图片离浏览器视窗顶部的距离
            const imageTop = image.getBoundingClientRect().top
            // 图片离浏览器视窗顶部的距离 < 浏览器视窗的长度
            // 说明图片在可见区
            if (imageTop < window.innerHeight){
                //把不能使用的data-src变成可以使用的src
                const data_src = image.getAttribute("data-src")
                image.setAttribute("src",data_src)
                //这个函数在触发后还会一直触发，需要改进
                console.log("触发1")
            }
        })
    })

//=======================================================================================================

    const images = document.querySelectorAll("img")
    const observer = new IntersectionObserver(
        // entries_arr是一个数组，每个成员都是一个IntersectionObserverEntry对象。
        // 举例来说，如果同时有两个被观察的对象的可见性发生变化，entries数组就会有两个成员。
        function (entries_arr) {
            entries_arr.forEach(function (entry) {
                    //intersectionRect：目标元素与视口（或根元素）的交叉区域的信息
                    //如果看得见元素就执行
                    if (entry.intersectionRect){
                        //target：被观察的目标元素，是一个 DOM 节点对象
                        const image = entry.target
                        // 获取相应节点的相应属性
                        const data_src = image.getAttribute("data-src")
                        //把不能使用的data-src变成可以使用的src
                        image.setAttribute("src",data_src)
                        // 停止观察
                        observer.unobserve(image);
                        //这个函数不会一直触发
                        console.log("触发2")

                    }
            })
    })
    //为每张图片添加observe方法
    images.forEach(image=>{
        observer.observe(image)
    })
</script>
</html>